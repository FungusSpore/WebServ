<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ“¤ File Upload - Prophet Web Server</title>
  
  <!-- Use main theme CSS -->
  <link rel="stylesheet" href="/css/style.css">
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  
  <style>
    /* Upload-specific styles */
    .upload-area {
      border: 3px dashed #3498db;
      border-radius: 15px;
      padding: 40px;
      text-align: center;
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      transition: all 0.3s ease;
      margin: 20px 0;
      cursor: pointer;
    }
    
    .upload-area:hover, .upload-area.dragover {
      border-color: #2980b9;
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      transform: scale(1.02);
    }
    
    .upload-icons {
      font-size: 3em;
      color: #3498db;
      margin-bottom: 20px;
    }
    
    .upload-icons i {
      margin: 0 10px;
      animation: float 3s ease-in-out infinite;
    }
    
    .upload-icons i:nth-child(2) {
      animation-delay: 0.5s;
    }
    
    .upload-icons i:nth-child(3) {
      animation-delay: 1s;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    
    .file-info {
      background: white;
      border-radius: 10px;
      padding: 15px;
      margin: 15px 0;
      border-left: 5px solid #27ae60;
      display: none;
    }
    
    .progress-bar {
      width: 100%;
      height: 20px;
      background: #ecf0f1;
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      width: 0%;
      transition: width 0.3s ease;
    }
  </style>
</head>
<body>
  <div class="container fade-in">
    <!-- Navigation -->
    <nav class="nav">
      <div class="logo">ğŸš€ Prophet Server</div>
      <ul class="nav-links">
        <li><a href="/">Home</a></li>
        <li><a href="/about.html">About</a></li>
        <li><a href="/cgi-bin/login.py">Login</a></li>
        <li><a href="/upload/uploadFile.html">Upload</a></li>
      </ul>
    </nav>

    <!-- Main Content -->
    <h1>ğŸ“¤ File Upload Center</h1>
    
    <div class="text-center mb-3">
      <span class="status running">ğŸ“¡ Upload Ready</span>
      <span class="highlight">Drag & Drop Supported</span>
    </div>

    <form action="/cgi-bin/uploadFilesMy.py" method="POST" enctype="multipart/form-data" id="upload-form">
      <div class="upload-area" id="upload-area">
        <div class="upload-icons">
          <i class="fas fa-file-image"></i>
          <i class="fas fa-file-alt"></i>
          <i class="fas fa-file-pdf"></i>
        </div>
        
        <input type="file" name="file" id="file-upload" hidden multiple>
        
        <h3>Drop files here to upload</h3>
        <p>or <a href="#" id="file-browser" class="highlight">click to browse</a> your computer</p>
        
        <div class="mt-2">
          <small>Supported: Images, Documents, Text files, etc.</small>
        </div>
      </div>
      
      <div class="file-info" id="file-info">
        <h4>ğŸ“„ Selected Files:</h4>
        <div id="file-list"></div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="text-center mt-2">
          <button type="submit" class="button success">
            <i class="fas fa-cloud-upload-alt"></i> Upload Files
          </button>
          <button type="button" class="button secondary" id="clear-files">
            <i class="fas fa-times"></i> Clear
          </button>
        </div>
      </div>
    </form>

    <!-- Upload Tips -->
    <div class="card mt-3">
      <h3>ğŸ’¡ Upload Tips</h3>
      <ul class="feature-list">
        <li>ğŸ“ Multiple files can be selected at once</li>
        <li>ğŸ–±ï¸ Drag and drop files directly onto the upload area</li>
        <li>ğŸ“ Check server configuration for file size limits</li>
        <li>ğŸ”’ Files are processed securely through CGI</li>
      </ul>
    </div>

    <!-- Quick Actions -->
    <div class="text-center mt-3">
      <a href="/" class="button secondary">ğŸ  Back to Home</a>
      <a href="/cgi-bin/browse_uploads.py" class="button">ğŸ“‚ View Uploads</a>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>Secure file upload powered by Prophet Web Server CGI</p>
    </div>
  </div>

  <script>
    // Enhanced upload functionality
    const uploadArea = document.getElementById('upload-area');
    const fileInput = document.getElementById('file-upload');
    const fileBrowser = document.getElementById('file-browser');
    const fileInfo = document.getElementById('file-info');
    const fileList = document.getElementById('file-list');
    const clearBtn = document.getElementById('clear-files');
    const progressFill = document.getElementById('progress-fill');

    // File browser click
    fileBrowser.addEventListener('click', (e) => {
      e.preventDefault();
      fileInput.click();
    });

    // Upload area click
    uploadArea.addEventListener('click', () => {
      fileInput.click();
    });

    // Drag and drop events
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      fileInput.files = e.dataTransfer.files;
      handleFiles();
    });

    // File selection
    fileInput.addEventListener('change', handleFiles);

    // Clear files
    clearBtn.addEventListener('click', () => {
      fileInput.value = '';
      fileInfo.style.display = 'none';
      progressFill.style.width = '0%';
    });

    function handleFiles() {
      const files = fileInput.files;
      if (files.length > 0) {
        fileInfo.style.display = 'block';
        fileList.innerHTML = '';
        
        Array.from(files).forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.innerHTML = `
            <strong>${file.name}</strong> 
            <span class="status">${formatFileSize(file.size)}</span>
          `;
          fileList.appendChild(fileItem);
        });
        
        // Simulate progress (for demo)
        let progress = 0;
        const interval = setInterval(() => {
          progress += 10;
          progressFill.style.width = progress + '%';
          if (progress >= 100) {
            clearInterval(interval);
          }
        }, 100);
      }
    }

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
  </script>
</body>
</html>
